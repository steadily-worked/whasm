## 클로저

러스트의 디자인은, 기존의 많은 언어와 기술에서 영감을 얻었으며 영향을 받은 중요한 것 중 하나에는 함수형 프로그래밍이 있다.
함수형 스타일의 프로그래밍은, 대개

1. 함수를 값처럼 인수로 넘기는 것
2. 다른 함수들에서 결괏값으로 함수들을 반환하는 것
3. 나중에 실행하기 위해 함수를 변수에 할당하는 것 등을 포함한다.

다른 언어에서 자주 함수형으로 언급되는 특성들과 유사한 러스트의 특성들에 대해 논의할 것이다.
구체적으로는:

1. 클로저: 변수에 저장할 수 있는 함수와 유사한 구조
2. 반복자: 일련의 요소들을 처리할 수 있는 방법
3. 클로저와 반복자를 사용하여 커맨드 라인 프로젝틀르 개선할 수 있는 방법
4. 클로저와 반복자의 성능

### 캡처된 값을 밖으로 이동하기

어떤 클로저가 자신이 정의된 환경으로부터 값의 참조자 혹은 소유권을 캡처하면(따라서 클로저의 안으로 이동되는 것에 영향을 준다면),
클로저 본문의 코드는 이 클로저가 나중에 평가될 때 그 참조자나 값에 어떤 일이 발생하는지 정의한다(그래서 클로저의 밖으로 무언가 이동되는 것에 영향을 준다).
클로저 본문은 다음의 것들을 할 수 있다:

1. 캡처된 값을 클로저 밖으로 이동시키기
2. 캡처된 값을 변형하기
3. 이동시키지도 변형시키지도 않기, 혹은 시작 단계에서부터 환경으로부터 아무 값도 캡처하지 않기.

클로저가 환경으로부터 값을 캡처하고 다루는 방식은, 이 클로자가 구현하는 트레이트에 영향을 주고, 트레이트는 함수와 구조체가 사용할 수 있는 클로저의 종류를 명시할 수 있는 방법이다. 클로저는 클로저의 본문이 값을 처리하는 방식에 따라서 이 `Fn` 트레이트들 중 하나, 둘, 혹은 셋 모두를 추가하는 방식으로 자동 구현한다.

1. `FnOnce`는 한번만 호출될 수 있는 클로저에게 적용된다. 모든 클로저들은 호출될 수 있으므로, 최소한 이 트레이트는 구현해 둔다. 캡처된 값을 본문 밖으로 이동시키는 클로저에 대해서는 `FnOnce`만 구현하면 되며, 나머지 `Fn` 트레이트는 구현되지 않는데, 이는 이 클로저가 한 번만 호출될 수 있기 때문이다.
2. `FnMut`는 본문 밖으로 캡처된 값을 이동시키지는 않지만, 값을 변경할 수는 있는 클로저에 대해 적용된다. 이러한 클로저는 한 번 이상 호출될 수 있다.
3. `Fn`은 캡처된 값을 본문 밖으로 이동시키지 않고, 캡처된 값을 변경하지도 않는 클로저는 물론, 환경으로부터 아무런 값도 캡처하지 않는 클로저에 적용된다. 이러한 클로저는 자신의 환경을 변경시키지 않으면서 한번 이상 호출될 수 있는데, 이는 클로저가 동시에 여러번 호출되는 등의 경우에서 중요하다.
